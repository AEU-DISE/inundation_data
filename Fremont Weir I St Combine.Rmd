---
title: "FW and ISt Combine"
author: "Lisa Vance"
date: "`r Sys.Date()`"
output: html_document
---

Code for combining Fremont Weir and I St stage data for inundation estimate

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. Retrieve Fremont Weir and I St stage data from WDL:
   Select custom range - YBFMP monitoring starts 1998 and select through date range for publishing

  Fremont Weir(Station #A02170):
  https://wdl.water.ca.gov/WaterDataLibrary/StationDetails.aspx?Station=A02170&source=map

  I St(Station #A02100): https://wdl.water.ca.gov/WaterDataLibrary/StationDetails.aspx?Station=A02100&source=map

2. Packages
```{r setup, include=FALSE}
library(readr)
library(ggplot2)
library(lubridate)
library(rcompanion)
library(viridis)
library(dplyr)
library(ggthemes)
library(tidyverse)
library(rcartocolor)
library(tidylog)
```

3. Load files

```{r}

#WDL includes a lot of information at the top of the exported csv, skip for easier column headers 
FW <- read_csv("Working files/A02170_Stage_Daily_Mean.csv", skip =8)
ISt <- read_csv("Working files/A02100_Stage_Daily_Mean.csv", skip = 8)
```

4. Rename columns and adjust files for calculating estimated inundation at each sensor

```{r}

ISt <- ISt %>%
  rename(DateTime = 'Date Time',
         StageISt = 'Stage Daily Mean (FOOT)',
         QualityCodeISt = 'Quality Code') %>%
  select(-c(QualityCodeISt))

FW <- FW %>%
  rename(DateTime = 'Date Time',
         StageFW = 'Stage Daily Mean (FOOT)',
         QualityCodeFW = 'Quality Code') %>%
  select(-c(QualityCodeFW))

StagesJoined <- FW %>%
  left_join(ISt, by = "DateTime")

write_csv(StagesJoined, "StagesJoined.csv")

Inundation <- StagesJoined %>%
  mutate(InundationFW = ifelse(StageFW >= "32", "Inundated", "Not Inundated"),
         InundationISt = ifelse(StageISt >= "17", "Inundated", "Not Inundated"))

#first few ISt stages show as inundated, incorrectly...why?

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
